{% load static %} 
{% load user_tags %} 

<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visualizar Avalia√ß√£o - IF SADD</title>

    <!-- CSS personalizado -->
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'css/global.css' %}"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'css/visualizar_avaliacao.css' %}"
    />
  </head>

  <body>
    <main>
      <div class="container">
        <a href="{% url 'inicio' %}" class="back-button">‚Üê Voltar</a>

        <!-- Header da p√°gina -->
        <div class="header">
          <h1>Visualizar Avalia√ß√£o</h1>
          <p>
            {{ avaliacao.disciplina.disciplina_nome }} - {{ avaliacao.turma.codigo_turma }}
          </p>
        </div>

        <!-- Mensagens -->
        {% include "partials/messages.html" %}

        <!-- Conte√∫do principal -->
        <div class="form-section">
          <!-- Informa√ß√µes da Avalia√ß√£o -->
          <div class="avaliacao-card">
            <div class="avaliacao-header">
              <div class="avaliacao-info">
                <h3>{{ titulo }}</h3>
                <p>
                  <strong>Disciplina:</strong> {{ avaliacao.disciplina.disciplina_nome }}
                </p>
                <p>
                  <strong>Turma:</strong> {{ avaliacao.turma.codigo_turma }}
                </p>
                <p><strong>Ciclo:</strong> {{ avaliacao.ciclo.nome }}</p>
                <p>
                  <strong>Question√°rio:</strong> {{ avaliacao.ciclo.questionario.titulo }}
                </p>
              </div>
              <div class="avaliacao-status">
                <span class="status-badge"> ‚úì Avalia√ß√£o Respondida </span>
                {% if avaliacao.data_resposta %}
                <div class="data-resposta">
                  üìÖ {{ avaliacao.data_resposta|date:"d/m/Y √†s H:i" }}
                </div>
                {% endif %}
              </div>
            </div>

            <div class="info-alert">
              üîí <strong>Avalia√ß√£o An√¥nima:</strong> As respostas foram
              coletadas de forma an√¥nima.
            </div>
          </div>

          <!-- Respostas -->
          {% for resposta in respostas %}
          <div class="pergunta-card">
            <div class="pergunta-header">
              <h6 class="pergunta-titulo">
                {{ resposta.pergunta.enunciado }} {% if resposta.pergunta.obrigatoria %}
                <span style="color: var(--cor08)">*</span>
                {% endif %}
              </h6>
              <div class="pergunta-badges">
                {% if resposta.pergunta.categoria %}
                <span class="pergunta-badge"
                  >{{ resposta.pergunta.categoria.nome }}</span
                >
                {% endif %}
                <span class="pergunta-badge"
                  >{{ resposta.pergunta.get_tipo_display }}</span
                >
              </div>
            </div>

            <div class="resposta-container">
              {% if resposta.pergunta.tipo == 'likert' %}
              <div class="likert-scale">
                <span class="likert-labels">Discordo Totalmente</span>
                <div class="likert-options">
                  {% for i in "12345" %}
                  <div
                    class="likert-option {% if resposta.valor_numerico|stringformat:"d" == i %}selected{% endif %}"
                  >
                    {{ i }}
                  </div>
                  {% endfor %}
                </div>
                <span class="likert-labels">Concordo Totalmente</span>
              </div>
              <div class="resposta-valor">
                <strong
                  >Resposta Selecionada: {{ resposta.valor_numerico }}</strong
                >
              </div>

              {% elif resposta.pergunta.tipo == 'nps' %}
              {% nps_scale as escala %}
              <div class="nps-container">
                <div class="nps-labels">
                  <span>0 - Nunca recomendaria</span>
                  <span>10 - Certamente recomendaria</span>
                </div>
                <div class="nps-options">
                  {% for i in escala %}
                  <div
                    class="nps-option {% if resposta.valor_numerico == i %}selected{% endif %}"
                  >
                    {{ i }}
                  </div>
                  {% endfor %}
                </div>
                <div class="resposta-valor">
                  <strong>Nota Atribu√≠da: {{ resposta.valor_numerico }}</strong>
                </div>
              </div>

              {% elif resposta.pergunta.tipo == 'sim_nao' %}
              <div
                class="resposta-binaria {% if resposta.valor_boolean %}resposta-true{% elif resposta.valor_boolean is not None %}resposta-false{% else %}resposta-indefinida{% endif %}"
              >
                {% if resposta.valor_boolean is not None %} {% if resposta.valor_boolean %}‚úì Sim{% else %}‚úó N√£o{% endif %} {% else %} {{ resposta.valor_texto|default:"-" }} {% endif %}
              </div>

              {% elif resposta.pergunta.tipo == 'multipla_escolha' %}
              <div class="resposta-destaque">{{ resposta.valor_texto }}</div>

              {% elif resposta.pergunta.tipo == 'texto_livre' %}
              <div class="resposta-texto">{{ resposta.valor_texto }}</div>
              {% endif %}
            </div>
          </div>
          {% endfor %}

          <!-- Coment√°rio Geral -->
          {% if avaliacao.comentario_geral %}
          <div class="comentario-card">
            <h6>üí¨ Coment√°rio Adicional</h6>
            <div class="resposta-texto">{{ avaliacao.comentario_geral }}</div>
          </div>
          {% endif %}

          <!-- Navega√ß√£o -->
          <div class="navegacao-footer">
            <a href="{% url 'listar_avaliacoes' %}" class="btn-custom">
              ‚Üê Voltar para Lista
            </a>
            <a href="javascript:window.print()" class="btn-custom">
              üñ®Ô∏è Imprimir
            </a>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
