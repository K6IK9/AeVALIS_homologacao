{% load user_tags %} {% load static %}

<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IF SADD - Perfil do Usuário</title>
    <meta
      name="description"
      content="Perfil do usuário - Sistema de Avaliação Docente"
    />

    <!-- CSS Global -->
    <link rel="stylesheet" href="{% static 'css/global.css' %}" />
    <!-- CSS Específico do Perfil -->
    <link rel="stylesheet" href="{% static 'css/perfil.css' %}" />

    <!-- Ícones Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>

  <body>
    <!-- Conteúdo Principal -->
    <main class="profile-main">
      <div class="profile-container">
        <!-- Seção do Avatar e Header -->
        <section class="profile-hero">
          <!-- Navegação integrada -->
          <div class="profile-nav">
            <a
              href="{% url 'inicio' %}"
              class="nav-btn"
              title="Voltar ao Início"
            >
              <i class="fas fa-home"></i>
              <span>Início</span>
            </a>
            <div class="nav-logo">
              <img src="{% static 'assets/saad_logo.svg' %}" alt="IF SADD" />
            </div>
          </div>

          <div class="profile-content-hero">
            <div class="profile-avatar">
              <div class="avatar-circle">
                <i class="fas fa-user-circle"></i>
              </div>
              <div class="role-badge {{ user|get_user_role_class }}">
                <i class="fas fa-shield-alt"></i>
                {{ user|get_user_role }}
              </div>
            </div>

            <div class="profile-intro">
              <h1 class="profile-name">
                {{ user.first_name }} {{ user.last_name }}
              </h1>
              <p class="profile-type">{{ user|get_user_profile_type }}</p>
              <div class="profile-status">
                <span class="status-indicator active"></span>
                <span>Usuário Ativo</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Grid de Informações -->
        <section class="profile-content">
          <!-- Informações Pessoais -->
          <div class="info-card">
            <div class="card-header">
              <h2><i class="fas fa-user"></i> Informações Pessoais</h2>
            </div>
            <div class="card-body">
              <div class="info-grid">
                <div class="info-item">
                  <div class="info-icon">
                    <i class="fas fa-id-card"></i>
                  </div>
                  <div class="info-details">
                    <label>Nome Completo</label>
                    <span>{{ user.first_name }} {{ user.last_name }}</span>
                  </div>
                </div>

                <div class="info-item">
                  <div class="info-icon">
                    <i class="fas fa-hashtag"></i>
                  </div>
                  <div class="info-details">
                    <label>Matrícula/Username</label>
                    <span>{{ user.username }}</span>
                  </div>
                </div>

                <div class="info-item">
                  <div class="info-icon">
                    <i class="fas fa-envelope"></i>
                  </div>
                  <div class="info-details">
                    <label>E-mail</label>
                    <span>{{ user.email|default:"Não informado" }}</span>
                  </div>
                </div>

                <div class="info-item">
                  <div class="info-icon">
                    <i class="fas fa-calendar-alt"></i>
                  </div>
                  <div class="info-details">
                    <label>Membro desde</label>
                    <span>{{ user.date_joined|date:"d/m/Y" }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Informações do Sistema -->
          <div class="info-card">
            <div class="card-header">
              <h2><i class="fas fa-cogs"></i> Sistema & Permissões</h2>
            </div>
            <div class="card-body">
              <div class="system-info">
                <div class="permission-item">
                  <div class="permission-icon {{ user|get_user_role_class }}">
                    <i class="fas fa-user-tag"></i>
                  </div>
                  <div class="permission-details">
                    <label>Função no Sistema</label>
                    <span>{{ user|get_user_role }}</span>
                  </div>
                </div>

                <div class="permission-item">
                  <div class="permission-icon">
                    <i class="fas fa-clock"></i>
                  </div>
                  <div class="permission-details">
                    <label>Último Acesso</label>
                    <span>
                      {{ user.last_login|date:"d/m/Y H:i"|default:"Nunca" }}
                    </span>
                  </div>
                </div>

                {% if user|is_admin %}
                <div class="permission-item highlighted">
                  <div class="permission-icon admin">
                    <i class="fas fa-crown"></i>
                  </div>
                  <div class="permission-details">
                    <label>Privilégios Administrativos</label>
                    <span>Acesso total ao sistema</span>
                  </div>
                </div>
                {% endif %} {% if user|is_coordenador %}
                <div class="permission-item highlighted">
                  <div class="permission-icon coordenador">
                    <i class="fas fa-users-cog"></i>
                  </div>
                  <div class="permission-details">
                    <label>Coordenação</label>
                    <span>Gestão de avaliações e relatórios</span>
                  </div>
                </div>
                {% endif %}
              </div>
            </div>
          </div>
        </section>

        <!-- Ações do Perfil -->
        <section class="profile-actions">
          <div class="actions-grid">
            {% if user|can_access_admin %}
            <a href="{% url 'admin_hub' %}" class="action-btn secondary">
              <i class="fas fa-tools"></i>
              <span>Área Administrativa</span>
            </a>
            {% endif %}

            <form
              method="post"
              action="/accounts/logout/?next=/accounts/login/"
              class="logout-form"
            >
              {% csrf_token %}
              <button
                type="submit"
                class="action-btn danger"
                onclick="return confirm('Tem certeza que deseja sair do sistema?');"
              >
                <i class="fas fa-sign-out-alt"></i>
                <span>Sair do Sistema</span>
              </button>
            </form>
          </div>
        </section>
      </div>
    </main>

    <!-- Scripts -->
    <script>
      // Adicionar interatividade básica
      document.addEventListener("DOMContentLoaded", function () {
        // Efeito de hover nos cards
        const cards = document.querySelectorAll(".info-card");
        cards.forEach((card) => {
          card.addEventListener("mouseenter", function () {
            this.style.transform = "translateY(-5px)";
          });

          card.addEventListener("mouseleave", function () {
            this.style.transform = "translateY(0)";
          });
        });

        // Animação de entrada
        const elements = document.querySelectorAll(".info-card, .profile-hero");
        elements.forEach((el, index) => {
          el.style.animationDelay = `${index * 0.1}s`;
          el.classList.add("fade-in-up");
        });
      });
    </script>
  </body>
</html>
